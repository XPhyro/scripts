#!/usr/bin/env sh

waloc="$( getloc wa )" || {
    printf "[ERROR]: getloc failed, aborting.\n"
    exit 1
}

fls="$( find "$waloc" -mindepth 1 -maxdepth 1 -type f -o -type l )"

while true
do
    printf "%s\n" "$fls" | shuf -r | while IFS= read -r i
    do
        cmp -s "$i" "$last" 2> /dev/null && continue
        hsetroot -cover "$i" > /dev/null
        last="$i"
        sleep "$@"
    done
done
